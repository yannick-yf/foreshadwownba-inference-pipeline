schema: '2.0'
stages:
  get_data:
    cmd: python -m pipeline.get_data --config=params.yaml
    deps:
    - path: pipeline/get_data.py
      hash: md5
      md5: 7270866e82cd882b459dc956673900ef
      size: 1873
    params:
      params.yaml:
        base:
          log_level: INFO
          random_state: 42
        get_training_dataset:
          dataset: data/input/nba_training_dataset.csv
    outs:
    - path: data/input/nba_games_training_dataset.csv
      hash: md5
      md5: b3a6eebcd23fa0f006f33d0dab00a608
      size: 1017744
  get_training_dataset:
    cmd:
    - aws s3 cp s3://foreshadownba/dvc-data-pipeline-output/nba_games_inseason_dataset_final.csv
      ./data/input/nba_games_inseason_dataset_final.csv --profile=ipfy
    outs:
    - path: ./data/input/nba_games_inseason_dataset_final.csv
      hash: md5
      md5: bdb0b0c25b43cad4982a764a8f62988f
      size: 189108
  get_inseason_dataset:
    cmd:
    - aws s3 cp s3://foreshadownba/dvc-data-pipeline-output/nba_games_inseason_dataset_final.csv
      ./data/input/nba_games_inseason_dataset_final.csv --profile=ipfy
    outs:
    - path: ./data/input/nba_games_inseason_dataset_final.csv
      hash: md5
      md5: bbcd81483f3348b477b62e76ddd31d41
      size: 219023
  get_models:
    cmd:
    - aws s3 cp s3://foreshadownba/dvc-ml-pipeline-output/model.joblib ./models/model.joblib
      --profile=ipfy
    - aws s3 cp s3://foreshadownba/dvc-ml-pipeline-output/columns_selected.csv ./models/columns_selected.csv
      --profile=ipfy
    outs:
    - path: ./models/model.joblib
      hash: md5
      md5: 88a46e49b26a2134cdc660ef5d27c8f1
      size: 1693511
  inference:
    cmd:
    - python3 -m src.inference --inseason-dataset-file-path ./data/input/nba_games_inseason_dataset_final.csv
      --model-column ./models/columns_selected.csv --model-file-path ./models/model.joblib
      --target-variable results --group-cv-variable id --inference-dataset-output
      ./data/output/nba_games_inseasonn_w_pred.csv
    deps:
    - path: ./models/model.joblib
      hash: md5
      md5: 88a46e49b26a2134cdc660ef5d27c8f1
      size: 1693511
    - path: src/inference.py
      hash: md5
      md5: 27f03786f3e6496ad8d795ede77f707d
      size: 7810
    params:
      params.yaml:
        base:
          log_level: INFO
          random_state: 42
        get_inseason_dataset:
          dataset: ./data/input/nba_games_inseason_dataset_final.csv
        get_models:
          model: ./models/model.joblib
          model_columns: ./models/columns_selected.csv
        inference:
          target_variable: results
          group_cv_variable: id
          dataset: ./data/output/nba_games_inseasonn_w_pred.csv
    outs:
    - path: ./data/output/nba_games_inseasonn_w_pred.csv
      hash: md5
      md5: c87e654ef49f26fb46e13b5338f448e9
      size: 27814
  write_final_model_to_s3:
    cmd:
    - aws s3 cp ./data/output/nba_games_inseasonn_w_pred.csv s3://foreshadownba/inference-pipeline-output/
      --profile=ipfy
    deps:
    - path: ./data/output/nba_games_inseasonn_w_pred.csv
      hash: md5
      md5: c87e654ef49f26fb46e13b5338f448e9
      size: 27814
